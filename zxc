-- Roblox ç‰©å“ä¼ é€è„šæœ¬
-- æ˜¾ç¤º workspace.game.map.items ä¸­çš„ç‰©å“ï¼Œç‚¹å‡»å¯ä¼ é€åˆ°ç‰©å“ä½ç½®ï¼ˆ500ç±³èŒƒå›´å†…ï¼‰

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local localPlayer = Players.LocalPlayer
if not localPlayer then
    Players:GetPropertyChangedSignal("LocalPlayer"):Wait()
    localPlayer = Players.LocalPlayer
end

local itemsFolder = workspace:FindFirstChild("game") and workspace.game:FindFirstChild("map") and workspace.game.map:FindFirstChild("items")

if not itemsFolder then
    warn("æ— æ³•æ‰¾åˆ° items æ–‡ä»¶å¤¹ï¼Œè¯·æ£€æŸ¥è·¯å¾„ï¼šworkspace.game.map.items")
    return
end

-- é…ç½®
local MAX_DISTANCE = 500 -- æœ€å¤§æ£€æµ‹è·ç¦»ï¼ˆç±³ï¼‰
local TELEPORT_HEIGHT = 5 -- ä¼ é€æ—¶è·ç¦»åœ°é¢çš„é«˜åº¦
local UPDATE_INTERVAL = 1 -- æ›´æ–°é—´éš”ï¼ˆç§’ï¼‰
local ENABLE_HIGHLIGHT = true -- æ˜¯å¦å¯ç”¨é«˜äº®

-- å­˜å‚¨ç‰©å“æ•°æ®
local itemsData = {}
local guiElements = {}
local enabled = true

-- ç‰©å“åç§°ç¿»è¯‘å­—å…¸ï¼ˆå¯é€‰ï¼‰
local itemTranslations = {
    ["mug"] = "æ¯å­",
    ["bandage"] = "ç»·å¸¦",
    ["Mug"] = "æ¯å­",
    ["Bandage"] = "ç»·å¸¦",
}

-- é¢œè‰²é…ç½®
local Colors = {
    Background = Color3.fromRGB(30, 30, 40),
    Text = Color3.fromRGB(255, 255, 255),
    Button = Color3.fromRGB(60, 60, 80),
    ButtonHover = Color3.fromRGB(80, 80, 100),
    CloseButton = Color3.fromRGB(200, 80, 80),
    CloseButtonHover = Color3.fromRGB(220, 100, 100),
    ItemButton = Color3.fromRGB(50, 50, 70),
    ItemButtonHover = Color3.fromRGB(70, 70, 90),
    DistanceNear = Color3.fromRGB(0, 255, 0),    -- ç»¿è‰²ï¼ˆè¿‘ï¼‰
    DistanceMedium = Color3.fromRGB(255, 255, 0), -- é»„è‰²ï¼ˆä¸­ï¼‰
    DistanceFar = Color3.fromRGB(255, 100, 100),  -- çº¢è‰²ï¼ˆè¿œï¼‰
}

-- å·¥å…·å‡½æ•°
local function getDistanceFromPlayer(position)
    local character = localPlayer.Character
    if not character then return math.huge end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return math.huge end
    
    return (humanoidRootPart.Position - position).Magnitude
end

local function translateItemName(name)
    if itemTranslations[name] then
        return itemTranslations[name]
    end
    local lowerName = name:lower()
    if itemTranslations[lowerName] then
        return itemTranslations[lowerName]
    end
    return name
end

local function formatDistance(distance)
    return string.format("%.1fç±³", distance)
end

-- æ‰«æç‰©å“
local function scanItems()
    itemsData = {}
    
    local character = localPlayer.Character
    local humanoidRootPart = character and character:FindFirstChild("HumanoidRootPart")
    
    for _, item in pairs(itemsFolder:GetChildren()) do
        local position = nil
        local modelName = item.Name
        
        -- è·å–ç‰©å“ä½ç½®
        if item:IsA("Model") then
            local primaryPart = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
            if primaryPart then
                position = primaryPart.Position
            end
        elseif item:IsA("BasePart") then
            position = item.Position
        end
        
        if position then
            local distance = humanoidRootPart and (humanoidRootPart.Position - position).Magnitude or math.huge
            
            if distance <= MAX_DISTANCE then
                table.insert(itemsData, {
                    instance = item,
                    name = modelName,
                    displayName = translateItemName(modelName),
                    position = position,
                    distance = distance,
                    lastUpdate = os.clock()
                })
            end
        end
    end
    
    -- æŒ‰è·ç¦»æ’åº
    table.sort(itemsData, function(a, b)
        return a.distance < b.distance
    end)
    
    return itemsData
end

-- ä¼ é€å‡½æ•°
local function teleportToItem(itemData)
    if not itemData then return end
    
    local character = localPlayer.Character
    if not character then return end
    
    local humanoid = character:FindFirstChild("Humanoid")
    if not humanoid then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    -- æ£€æŸ¥è·ç¦»
    local currentDistance = getDistanceFromPlayer(itemData.position)
    if currentDistance > MAX_DISTANCE then
        warn(string.format("ç‰©å“è·ç¦»å¤ªè¿œ (%.1fç±³ > %dç±³)", currentDistance, MAX_DISTANCE))
        return
    end
    
    -- è®¡ç®—ä¼ é€ä½ç½®ï¼ˆåœ¨ç‰©å“ä¸Šæ–¹ä¸€å®šé«˜åº¦ï¼‰
    local teleportPosition = itemData.position + Vector3.new(0, TELEPORT_HEIGHT, 0)
    
    -- ç¡®ä¿è§’è‰²ç«™ç«‹
    humanoid.PlatformStand = false
    
    -- å¹³æ»‘ä¼ é€ï¼ˆä½¿ç”¨Tweenï¼‰
    local tweenInfo = TweenInfo.new(
        0.5, -- æ—¶é—´
        Enum.EasingStyle.Quad, -- ç¼“åŠ¨ç±»å‹
        Enum.EasingDirection.Out -- æ–¹å‘
    )
    
    local tween = TweenService:Create(
        humanoidRootPart,
        tweenInfo,
        {CFrame = CFrame.new(teleportPosition)}
    )
    
    -- æ’­æ”¾ä¼ é€éŸ³æ•ˆï¼ˆå¯é€‰ï¼‰
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://1845271344" -- ä¼ é€éŸ³æ•ˆID
    sound.Volume = 0.5
    sound.Parent = humanoidRootPart
    sound:Play()
    game:GetService("Debris"):AddItem(sound, 3)
    
    -- ä¼ é€å®Œæˆåçš„æ•ˆæœ
    tween.Completed:Connect(function()
        -- æ·»åŠ ä¼ é€ç‰¹æ•ˆ
        local particles = Instance.new("ParticleEmitter")
        particles.Size = NumberSequence.new(0.5)
        particles.Transparency = NumberSequence.new(0.5)
        particles.Lifetime = NumberRange.new(0.5, 1)
        particles.Rate = 50
        particles.Speed = NumberRange.new(5)
        particles.VelocityInheritance = 0
        particles.Parent = humanoidRootPart
        particles:Emit(20)
        game:GetService("Debris"):AddItem(particles, 2)
        
        -- æ˜¾ç¤ºæç¤º
        local billboard = Instance.new("BillboardGui")
        billboard.Size = UDim2.new(0, 200, 0, 50)
        billboard.Adornee = humanoidRootPart
        billboard.StudsOffset = Vector3.new(0, 3, 0)
        billboard.AlwaysOnTop = true
        
        local textLabel = Instance.new("TextLabel")
        textLabel.Size = UDim2.new(1, 0, 1, 0)
        textLabel.BackgroundTransparency = 1
        textLabel.Text = "å·²ä¼ é€åˆ°: " .. itemData.displayName
        textLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
        textLabel.TextScaled = true
        textLabel.Font = Enum.Font.GothamBold
        textLabel.TextStrokeTransparency = 0.5
        textLabel.Parent = billboard
        
        billboard.Parent = humanoidRootPart
        game:GetService("Debris"):AddItem(billboard, 3)
    end)
    
    tween:Play()
end

-- åˆ›å»ºä¸»GUI
local function createMainGUI()
    -- åˆ›å»ºScreenGui
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "ItemTeleporterGUI"
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.Parent = game:GetService("CoreGui")
    
    -- ä¸»å®¹å™¨
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 350, 0, 450)
    mainFrame.Position = UDim2.new(0, 20, 0.5, -225)
    mainFrame.BackgroundColor3 = Colors.Background
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.ClipsDescendants = true
    
    -- åœ†è§’
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = mainFrame
    
    -- æ ‡é¢˜æ 
    local titleBar = Instance.new("Frame")
    titleBar.Name = "TitleBar"
    titleBar.Size = UDim2.new(1, 0, 0, 40)
    titleBar.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    titleBar.BorderSizePixel = 0
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 8)
    titleCorner.Parent = titleBar
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "Title"
    titleLabel.Size = UDim2.new(1, -40, 1, 0)
    titleLabel.Position = UDim2.new(0, 10, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "ğŸ“¦ ç‰©å“ä¼ é€å™¨ (500ç±³å†…)"
    titleLabel.TextColor3 = Colors.Text
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 18
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    -- å…³é—­æŒ‰é’®
    local closeButton = Instance.new("TextButton")
    closeButton.Name = "CloseButton"
    closeButton.Size = UDim2.new(0, 30, 0, 30)
    closeButton.Position = UDim2.new(1, -35, 0, 5)
    closeButton.BackgroundColor3 = Colors.CloseButton
    closeButton.Text = "Ã—"
    closeButton.TextColor3 = Colors.Text
    closeButton.Font = Enum.Font.GothamBold
    closeButton.TextSize = 20
    
    local closeButtonCorner = Instance.new("UICorner")
    closeButtonCorner.CornerRadius = UDim.new(0, 15)
    closeButtonCorner.Parent = closeButton
    
    -- ä¿¡æ¯æ 
    local infoBar = Instance.new("Frame")
    infoBar.Name = "InfoBar"
    infoBar.Size = UDim2.new(1, -20, 0, 30)
    infoBar.Position = UDim2.new(0, 10, 0, 50)
    infoBar.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
    infoBar.BackgroundTransparency = 0.2
    infoBar.BorderSizePixel = 0
    
    local infoCorner = Instance.new("UICorner")
    infoCorner.CornerRadius = UDim.new(0, 6)
    infoCorner.Parent = infoBar
    
    local itemCountLabel = Instance.new("TextLabel")
    itemCountLabel.Name = "ItemCount"
    itemCountLabel.Size = UDim2.new(0.5, 0, 1, 0)
    itemCountLabel.BackgroundTransparency = 1
    itemCountLabel.Text = "ç‰©å“: 0"
    itemCountLabel.TextColor3 = Colors.Text
    itemCountLabel.Font = Enum.Font.Gotham
    itemCountLabel.TextSize = 14
    itemCountLabel.TextXAlignment = Enum.TextXAlignment.Left
    itemCountLabel.PaddingLeft = UDim.new(0, 10)
    
    local updateTimeLabel = Instance.new("TextLabel")
    updateTimeLabel.Name = "UpdateTime"
    updateTimeLabel.Size = UDim2.new(0.5, 0, 1, 0)
    updateTimeLabel.Position = UDim2.new(0.5, 0, 0, 0)
    updateTimeLabel.BackgroundTransparency = 1
    updateTimeLabel.Text = "æœ€è¿‘: --:--"
    updateTimeLabel.TextColor3 = Colors.Text
    updateTimeLabel.Font = Enum.Font.Gotham
    updateTimeLabel.TextSize = 14
    updateTimeLabel.TextXAlignment = Enum.TextXAlignment.Right
    updateTimeLabel.PaddingRight = UDim.new(0, 10)
    
    -- ç‰©å“åˆ—è¡¨å®¹å™¨
    local itemsScrollingFrame = Instance.new("ScrollingFrame")
    itemsScrollingFrame.Name = "ItemsList"
    itemsScrollingFrame.Size = UDim2.new(1, -20, 1, -130)
    itemsScrollingFrame.Position = UDim2.new(0, 10, 0, 90)
    itemsScrollingFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    itemsScrollingFrame.BackgroundTransparency = 0.1
    itemsScrollingFrame.BorderSizePixel = 0
    itemsScrollingFrame.ScrollBarThickness = 6
    itemsScrollingFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 120)
    itemsScrollingFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y
    
    local listCorner = Instance.new("UICorner")
    listCorner.CornerRadius = UDim.new(0, 6)
    listCorner.Parent = itemsScrollingFrame
    
    -- æŒ‰é’®å®¹å™¨
    local buttonContainer = Instance.new("Frame")
    buttonContainer.Name = "ButtonContainer"
    buttonContainer.Size = UDim2.new(1, -20, 0, 40)
    buttonContainer.Position = UDim2.new(0, 10, 1, -50)
    buttonContainer.BackgroundTransparency = 1
    
    -- åˆ·æ–°æŒ‰é’®
    local refreshButton = Instance.new("TextButton")
    refreshButton.Name = "RefreshButton"
    refreshButton.Size = UDim2.new(0.5, -5, 1, 0)
    refreshButton.BackgroundColor3 = Colors.Button
    refreshButton.Text = "ğŸ”„ åˆ·æ–°åˆ—è¡¨"
    refreshButton.TextColor3 = Colors.Text
    refreshButton.Font = Enum.Font.GothamBold
    refreshButton.TextSize = 14
    
    local refreshCorner = Instance.new("UICorner")
    refreshCorner.CornerRadius = UDim.new(0, 6)
    refreshCorner.Parent = refreshButton
    
    -- é«˜äº®åˆ‡æ¢æŒ‰é’®
    local highlightButton = Instance.new("TextButton")
    highlightButton.Name = "HighlightButton"
    highlightButton.Size = UDim2.new(0.5, -5, 1, 0)
    highlightButton.Position = UDim2.new(0.5, 5, 0, 0)
    highlightButton.BackgroundColor3 = Colors.Button
    highlightButton.Text = "ğŸ” é«˜äº®: å¼€å¯"
    highlightButton.TextColor3 = Colors.Text
    highlightButton.Font = Enum.Font.GothamBold
    highlightButton.TextSize = 14
    
    local highlightCorner = Instance.new("UICorner")
    highlightCorner.CornerRadius = UDim.new(0, 6)
    highlightCorner.Parent = highlightButton
    
    -- ç»„è£…GUI
    titleLabel.Parent = titleBar
    closeButton.Parent = titleBar
    titleBar.Parent = mainFrame
    
    itemCountLabel.Parent = infoBar
    updateTimeLabel.Parent = infoBar
    infoBar.Parent = mainFrame
    
    refreshButton.Parent = buttonContainer
    highlightButton.Parent = buttonContainer
    buttonContainer.Parent = mainFrame
    
    itemsScrollingFrame.Parent = mainFrame
    mainFrame.Parent = screenGui
    
    -- å­˜å‚¨GUIå¼•ç”¨
    guiElements = {
        ScreenGui = screenGui,
        MainFrame = mainFrame,
        ItemsList = itemsScrollingFrame,
        ItemCountLabel = itemCountLabel,
        UpdateTimeLabel = updateTimeLabel,
        RefreshButton = refreshButton,
        HighlightButton = highlightButton,
        CloseButton = closeButton
    }
    
    -- æ·»åŠ äº¤äº’åŠŸèƒ½
    
    -- æ‹–æ‹½åŠŸèƒ½
    local dragging = false
    local dragStart, frameStart
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            frameStart = mainFrame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(
                frameStart.X.Scale,
                frameStart.X.Offset + delta.X,
                frameStart.Y.Scale,
                frameStart.Y.Offset + delta.Y
            )
        end
    end)
    
    -- æŒ‰é’®äº¤äº’æ•ˆæœ
    local function setupButtonHover(button, normalColor, hoverColor)
        button.MouseEnter:Connect(function()
            button.BackgroundColor3 = hoverColor
        end)
        button.MouseLeave:Connect(function()
            button.BackgroundColor3 = normalColor
        end)
    end
    
    setupButtonHover(closeButton, Colors.CloseButton, Colors.CloseButtonHover)
    setupButtonHover(refreshButton, Colors.Button, Colors.ButtonHover)
    setupButtonHover(highlightButton, Colors.Button, Colors.ButtonHover)
    
    return guiElements
end

-- åˆ›å»ºç‰©å“æŒ‰é’®
local function createItemButton(itemData, index)
    local button = Instance.new("TextButton")
    button.Name = "ItemButton_" .. index
    button.Size = UDim2.new(1, -10, 0, 60)
    button.Position = UDim2.new(0, 5, 0, (index - 1) * 65)
    button.BackgroundColor3 = Colors.ItemButton
    button.BorderSizePixel = 0
    button.Text = ""
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = button
    
    -- ç‰©å“åç§°æ ‡ç­¾
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Name = "Name"
    nameLabel.Size = UDim2.new(0.7, -5, 0.5, 0)
    nameLabel.Position = UDim2.new(0, 10, 0, 5)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = itemData.displayName
    nameLabel.TextColor3 = Colors.Text
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.TextSize = 16
    nameLabel.TextXAlignment = Enum.TextXAlignment.Left
    nameLabel.TextTruncate = Enum.TextTruncate.AtEnd
    
    -- åŸå§‹åç§°æ ‡ç­¾
    local originalNameLabel = Instance.new("TextLabel")
    originalNameLabel.Name = "OriginalName"
    originalNameLabel.Size = UDim2.new(0.7, -5, 0.5, 0)
    originalNameLabel.Position = UDim2.new(0, 10, 0.5, 0)
    originalNameLabel.BackgroundTransparency = 1
    originalNameLabel.Text = "(" .. itemData.name .. ")"
    originalNameLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
    originalNameLabel.Font = Enum.Font.Gotham
    originalNameLabel.TextSize = 12
    originalNameLabel.TextXAlignment = Enum.TextXAlignment.Left
    originalNameLabel.TextTruncate = Enum.TextTruncate.AtEnd
    
    -- è·ç¦»æ ‡ç­¾
    local distanceLabel = Instance.new("TextLabel")
    distanceLabel.Name = "Distance"
    distanceLabel.Size = UDim2.new(0.3, -10, 1, 0)
    distanceLabel.Position = UDim2.new(0.7, 5, 0, 0)
    distanceLabel.BackgroundTransparency = 1
    
    -- æ ¹æ®è·ç¦»è®¾ç½®é¢œè‰²
    local distanceColor
    if itemData.distance < 50 then
        distanceColor = Colors.DistanceNear
    elseif itemData.distance < 200 then
        distanceColor = Colors.DistanceMedium
    else
        distanceColor = Colors.DistanceFar
    end
    
    distanceLabel.Text = formatDistance(itemData.distance)
    distanceLabel.TextColor3 = distanceColor
    distanceLabel.Font = Enum.Font.GothamBold
    distanceLabel.TextSize = 18
    
    -- ä¼ é€å›¾æ ‡
    local teleportIcon = Instance.new("ImageLabel")
    teleportIcon.Name = "TeleportIcon"
    teleportIcon.Size = UDim2.new(0, 20, 0, 20)
    teleportIcon.Position = UDim2.new(1, -25, 0.5, -10)
    teleportIcon.BackgroundTransparency = 1
    teleportIcon.Image = "rbxassetid://3926307971" -- ä¼ é€å›¾æ ‡
    teleportIcon.ImageRectSize = Vector2.new(48, 48)
    teleportIcon.ImageRectOffset = Vector2.new(324, 364)
    teleportIcon.ImageColor3 = Color3.fromRGB(0, 200, 255)
    
    -- ç»„è£…æŒ‰é’®
    nameLabel.Parent = button
    originalNameLabel.Parent = button
    distanceLabel.Parent = button
    teleportIcon.Parent = button
    
    -- æŒ‰é’®äº¤äº’æ•ˆæœ
    button.MouseEnter:Connect(function()
        button.BackgroundColor3 = Colors.ItemButtonHover
        if ENABLE_HIGHLIGHT and itemData.instance then
            local highlight = itemData.instance:FindFirstChild("ItemTeleportHighlight")
            if not highlight then
                highlight = Instance.new("Highlight")
                highlight.Name = "ItemTeleportHighlight"
                highlight.FillColor = Color3.fromRGB(0, 200, 255)
                highlight.FillTransparency = 0.7
                highlight.OutlineColor = Color3.fromRGB(0, 150, 255)
                highlight.OutlineTransparency = 0
                highlight.Parent = itemData.instance
            end
            highlight.Enabled = true
        end
    end)
    
    button.MouseLeave:Connect(function()
        button.BackgroundColor3 = Colors.ItemButton
        if itemData.instance then
            local highlight = itemData.instance:FindFirstChild("ItemTeleportHighlight")
            if highlight then
                highlight.Enabled = false
            end
        end
    end)
    
    -- ç‚¹å‡»ä¼ é€
    button.MouseButton1Click:Connect(function()
        teleportToItem(itemData)
    end)
    
    return button
end

-- æ›´æ–°GUIåˆ—è¡¨
local function updateGUIList()
    if not guiElements.ItemsList then return end
    
    -- æ¸…ç©ºç°æœ‰åˆ—è¡¨
    for _, child in pairs(guiElements.ItemsList:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    -- æ‰«æç‰©å“
    local items = scanItems()
    
    -- æ›´æ–°è®¡æ•°
    guiElements.ItemCountLabel.Text = string.format("ç‰©å“: %d", #items)
    guiElements.UpdateTimeLabel.Text = string.format("æœ€è¿‘: %02d:%02d", 
        os.date("*t").min, os.date("*t").sec)
    
    -- åˆ›å»ºç‰©å“æŒ‰é’®
    for i, itemData in ipairs(items) do
        local button = createItemButton(itemData, i)
        button.Parent = guiElements.ItemsList
    end
    
    -- å¦‚æœæ²¡æœ‰ç‰©å“
    if #items == 0 then
        local emptyLabel = Instance.new("TextLabel")
        emptyLabel.Name = "EmptyLabel"
        emptyLabel.Size = UDim2.new(1, -20, 0, 100)
        emptyLabel.Position = UDim2.new(0, 10, 0, 10)
        emptyLabel.BackgroundTransparency = 1
        emptyLabel.Text = "500ç±³èŒƒå›´å†…æ²¡æœ‰å‘ç°ç‰©å“"
        emptyLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
        emptyLabel.Font = Enum.Font.Gotham
        emptyLabel.TextSize = 16
        emptyLabel.Parent = guiElements.ItemsList
    end
end

-- é«˜äº®ç®¡ç†
local function updateHighlights()
    if not ENABLE_HIGHLIGHT then return end
    
    for _, itemData in ipairs(itemsData) do
        if itemData.instance and not itemData.instance:FindFirstChild("ItemTeleportHighlight") then
            local highlight = Instance.new("Highlight")
            highlight.Name = "ItemTeleportHighlight"
            highlight.FillColor = Color3.fromRGB(0, 200, 255)
            highlight.FillTransparency = 0.8
            highlight.OutlineColor = Color3.fromRGB(0, 150, 255)
            highlight.OutlineTransparency = 0.2
            highlight.Enabled = false -- é»˜è®¤å…³é—­ï¼Œé¼ æ ‡æ‚¬åœæ—¶å¼€å¯
            highlight.Parent = itemData.instance
        end
    end
end

-- åˆå§‹åŒ–
local function initialize()
    -- åˆ›å»ºGUI
    createMainGUI()
    
    -- è®¾ç½®æŒ‰é’®äº‹ä»¶
    guiElements.RefreshButton.MouseButton1Click:Connect(function()
        updateGUIList()
    end)
    
    guiElements.HighlightButton.MouseButton1Click:Connect(function()
        ENABLE_HIGHLIGHT = not ENABLE_HIGHLIGHT
        guiElements.HighlightButton.Text = ENABLE_HIGHLIGHT and "ğŸ” é«˜äº®: å¼€å¯" or "ğŸ” é«˜äº®: å…³é—­"
        
        if not ENABLE_HIGHLIGHT then
            -- å…³é—­æ‰€æœ‰é«˜äº®
            for _, item in pairs(itemsFolder:GetChildren()) do
                local highlight = item:FindFirstChild("ItemTeleportHighlight")
                if highlight then
                    highlight:Destroy()
                end
            end
        end
    end)
    
    guiElements.CloseButton.MouseButton1Click:Connect(function()
        guiElements.ScreenGui:Destroy()
        enabled = false
    end)
    
    -- åˆå§‹æ‰«æ
    updateGUIList()
    updateHighlights()
    
    -- è®¾ç½®è‡ªåŠ¨æ›´æ–°
    spawn(function()
        while enabled and wait(UPDATE_INTERVAL) do
            if guiElements.ScreenGui and guiElements.ScreenGui.Parent then
                updateGUIList()
                updateHighlights()
            else
                break
            end
        end
    end)
end

-- å¯åŠ¨è„šæœ¬
initialize()

-- åˆ›å»ºå¯åŠ¨æŒ‰é’®ï¼ˆå¦‚æœGUIè¢«å…³é—­ï¼Œå¯ä»¥é‡æ–°æ‰“å¼€ï¼‰
local function createToggleButton()
    local toggleGui = Instance.new("ScreenGui")
    toggleGui.Name = "TeleporterToggle"
    
    local toggleButton = Instance.new("TextButton")
    toggleButton.Name = "Toggle"
    toggleButton.Size = UDim2.new(0, 50, 0, 50)
    toggleButton.Position = UDim2.new(1, -60, 0, 20)
    toggleButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    toggleButton.Text = "ğŸ“¦"
    toggleButton.TextColor3 = Colors.Text
    toggleButton.Font = Enum.Font.GothamBold
    toggleButton.TextSize = 20
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 25)
    corner.Parent = toggleButton
    
    toggleButton.MouseButton1Click:Connect(function()
        if not enabled or not guiElements.ScreenGui or not guiElements.ScreenGui.Parent then
            initialize()
        end
    end)
    
    toggleButton.Parent = toggleGui
    toggleGui.Parent = game:GetService("CoreGui")
end

-- åˆ›å»ºåˆ‡æ¢æŒ‰é’®
createToggleButton()
